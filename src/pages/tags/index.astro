---
import Base from '@/layouts/Base.astro';
import Section from '@/components/Section.astro';
import { getCollection } from 'astro:content';
import { AppConfig } from '@/utils/AppConfig';

const posts = await getCollection('posts');

// Get all unique tags and count posts per tag
const tagCounts: Record<string, number> = {};
posts.forEach(post => {
  if (post.data.tags) {
    post.data.tags.forEach(tag => {
      tagCounts[tag] = (tagCounts[tag] || 0) + 1;
    });
  }
});

const tags = Object.keys(tagCounts).sort();
---

<Base head={{ title: `Tags | ${AppConfig.title}`, description: AppConfig.description }}>
  <Section>
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold mb-4">Tags</h1>
      <p class="text-xl text-gray-600 dark:text-gray-400">Browse posts by tag</p>
    </div>
    
    <div class="grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-4">
      {tags.map((tag) => (
        <a href={`/tags/${tag}`} class="block">
          <div class="h-full rounded-2xl bg-stone-200/50 from-orange-900 via-amber-700 to-white p-[1px] text-sm shadow-[inset_0_0_0_1px_rgba(255,255,255,0.4)] hover:bg-gradient-to-r dark:bg-gray-900">
            <div class="flex h-full w-full flex-col rounded-[1rem] bg-stone-300 p-4 text-gray-900 opacity-90 dark:bg-stone-800 dark:text-white">
              <h3 class="text-lg font-bold mb-2">#{tag}</h3>
              <div class="text-sm font-medium text-orange-600 dark:text-orange-400">
                {tagCounts[tag]} posts
              </div>
            </div>
          </div>
        </a>
      ))}
    </div>
  </Section>
</Base> 